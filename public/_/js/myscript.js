function addPO(e){var t=$("#name"+e).text(),a=$("#brand"+e).text(),d=$("#unit"+e).text(),o=$(".product").DataTable(),r=o.row("#rowProd"+e).index();$(".POtable").append('<tr id="PO'+itemno+'"><td id="itemno'+itemno+'">'+itemno+'</td><td id="productId'+itemno+'">'+e+"</td>\n		<td>"+t+"</td><td>"+a+"</td><td>"+d+'</td>\n		<td class="light-green editable" id="prodQty'+e+'">1</td><td class="light-red editable" id="prodUnit'+e+'"></td>\n		<td class="cost" id="prodCost'+e+'">0.00</td><td >\n		<button class="btn btn-danger btn-xs square" id="removePO'+itemno+'" onclick="removePO('+itemno+","+e+","+r+')">\n		<i class="fa fa-times"></i> Remove</button></td></tr>'),itemno+=1,o.cell(r,4).data('<b class="success"> <i class="fa fa-check-circle"> Added</b>').draw(),$(".editable").editable({send:"never",type:"text",value:1,validate:function(e){return""==$.trim(e)?"This field is required":""==$.isNumeric(e)||0==e?"Please input a valid number greater than 0":void 0},emptytext:0,display:function(t){$(this).text(t),calcCost(e)}}),$("#savePO").removeClass("hidden")}function calcCost(e){var t=$("#prodQty"+e).text(),a=$("#prodUnit"+e).text();$("#prodCost"+e).text(t*a),totalCost()}function totalCost(){var e=0;$(".cost").each(function(){e+=parseInt($(this).text())}),$("#POTotalCost").text(e),(e=0)&&$("#savePO").addClass("hidden")}function removePO(e,t,a){var d=$(".product").DataTable();if(d.cell(a,4).data('<button class="btn btn-success btn-xs square" \n			onclick="addPO('+t+')" >\n			<i class="fa fa-check-circle"></i> Add</button>').draw(),$("#PO"+e).remove(),e+=1,$("#PO"+e).length)for(;itemno>e;)$("#PO"+e).attr("id","PO"+(e-1)),$("#itemno"+e).attr("id","itemno"+(e-1)),$("#itemno"+(e-1)).text(e-1),$("#productId"+e).attr("id","productId"+(e-1)),$("#removePO"+e).attr("id","removePO"+(e-1)),t=$("#productId"+(e-1)).text(),a=d.row("#rowProd"+t).index(),$("#removePO"+(e-1)).attr("onclick","removePO("+(e-1)+","+t+","+a+")"),e++;itemno-=1,totalCost()}function viewPO(e){$("#viewPOModal").modal("show"),$.post("/viewPO",{id:e},function(e){$("#vwPOId").text(e[0].id),$("#vwPODate").text(e[0].PODate),$("#vwSupplier").val(e[0].SupplierNo),"0"==e[0].Terms?$("#vwTerm").val("Cash"):$("#vwTerm").val(e[0].Terms),$("#vwPreparedBy").val(e[0].PreparedBy),""==e[0].ApprovedBy?$("#vwApprovedBy").val("N/A"):$("#vwApprovedBy").val(e[0].ApprovedBy)}),$.post("/viewPODetails",{id:e},function(e){$(".vwPOTable > tbody").html(""),counter=1;var t=0;$.each(e,function(e,a){$(".vwPOTable >tbody").append("<tr ><td>"+counter+"</td><td>"+a.ProductNo+"</td>\n	  					<td>"+a.ProductName+"</td>\n	  					<td>"+a.BrandName+"</td><td>"+a.Unit+"</td><td>"+a.Qty+"</td><td>"+a.CostPerQty+"</td>\n	  					<td>"+a.CostPerQty*a.Qty+"</td></tr>"),counter+=1,t+=a.CostPerQty*a.Qty}),$("#vwTotalCost").text(t)})}function editPO(e){$("#vwSaveBtn").addClass("hidden"),$("#editPOModal").modal("show"),$.post("/viewPO",{id:e},function(e){$("#edPOId").text(e[0].id),$("#edPODate").text(e[0].PODate),$('[name="vwSupplier"]').val(e[0].SupplierNo),"0"==e[0].Terms?($("#edTerm").val(0),$("#edTerm1").addClass("active"),$("#edTerm2").removeClass("active"),$("#edTermBox").addClass("hidden")):($("#edTerm").val(e[0].Terms),$("#edTerm1").removeClass("active"),$("#edTerm2").addClass("active"),$("#edTerm2").prop("disabled",!1),$("#edTermBox").removeClass("hidden")),$("#edPreparedBy").val(e[0].PreparedBy),""==e[0].ApprovedBy?$("#edApprovedBy").val("N/A"):$("#edApprovedBy").val(e[0].ApprovedBy)}),$.post("/viewPODetails",{id:e},function(e){$(".edPOTable > tbody").html(""),counter=1;var t=0;$.each(e,function(e,a){$(".edPOTable >tbody").append('<tr id="vwPO'+counter+'"><td id="vwItemno'+counter+'">'+counter+'</td><td id="vwProd'+a.ProductNo+'">'+a.ProductNo+"</td>\n	  					<td>"+a.ProductName+"</td>\n	  					<td>"+a.BrandName+"</td><td>"+a.Unit+'</td><td class="vweditable" id="edQty'+a.ProductNo+'">'+a.Qty+'</td><td class="vweditable" id="edUnit'+a.ProductNo+'">'+a.CostPerQty+'</td>\n	  					<td class="ecost"id="edCost'+a.ProductNo+'">'+a.CostPerQty*a.Qty+'</td><td><button class="btn btn-danger \n	  					btn-xs square dis" id="vwRemovePO'+counter+'" onclick="vwRemovePO('+counter+')" >\n						<i class="fa fa-times" ></i> Remove</button></td></tr>'),t+=a.CostPerQty*a.Qty,editable(a.ProductNo),counter+=1}),$("#edTotalCost").text(t)})}function editable(e){$(".vweditable").editable({send:"never",type:"text",validate:function(e){return""==$.trim(e)?"This field is required":""==$.isNumeric(e)||0==e?"Please input a valid number greater than 0":($("#vwSavePOBtn").removeClass("hidden"),void 0)},emptytext:0,display:function(t){$(this).text(t),edcalcCost(e)}})}function edcalcCost(e){var t=$("#edQty"+e).text(),a=$("#edUnit"+e).text();$("#edCost"+e).text(t*a),edtotalCost()}function edtotalCost(){var e=0;$(".ecost").each(function(){e+=parseInt($(this).text())}),$("#edPOTotalCost").text(e),0==e&&$("#vwSavePOBtn").addClass("hidden")}function vwaddPO(e){{var t=$("#vwname"+e).text(),a=$("#vwbrand"+e).text(),d=$("#vwunit"+e).text(),o=$(".vwproduct").DataTable();o.row("#vwrowProd"+e).index()}$("#vwProd"+e).length?$("#prodError").fadeIn("fast",function(){$("#prodError").fadeOut(4e3)}):($(".edPOTable >tbody").append('<tr id="vwPO'+counter+'"><td id="vwItemno'+counter+'">'+counter+'</td><td id="vwProd'+e+'">'+e+"</td>\n	  					<td>"+t+"</td>\n	  					<td>"+a+"</td><td>"+d+'</td><td class="vweditable" id="edQty'+e+'">1</td><td class="vweditable" id="edUnit'+e+'">1</td>\n	  					<td class="ecost"id="edCost'+e+'">1</td><td><button class="btn btn-danger \n	  					btn-xs square dis" id="vwRemovePO'+counter+'" onclick="vwRemovePO('+counter+')" >\n						<i class="fa fa-times" ></i> Remove</button></td></tr>'),counter+=1,editable(e),$("#vwSavePOBtn").removeClass("hidden"))}function vwRemovePO(e){if($("#vwPO"+e).remove(),e+=1,$("#vwPO"+e).length)for(;$("#vwPO"+e).length;)$("#vwPO"+e).attr("id","vwPO"+(e-1)),$("#vwItemno"+e).attr("id","vwItemno"+(e-1)),$("#vwItemno"+(e-1)).text(e-1),$("#vwRemovePO"+e).attr("id","vwRemovePO"+(e-1)),$("#vwRemovePO"+(e-1)).attr("onclick","vwRemovePO("+(e-1)+")"),e++;counter-=1,edtotalCost(),$("#vwSavePOBtn").removeClass("hidden")}function triggerEdit(e){$.get("toEditBank",{id:e},function(t){t&&($(".alert").remove(),$.each(t,function(t,a){$("#library-action").val(a.id),$(".name").val(a.BankName),$(".address").val(a.BAddress),$(".telephone").val(a.Telephone),$(".deactivate").attr("href","/delete-bank/"+e),$(".delete").show()}))}),$("#bank-library").modal("show")}function triggerEditBranch(e){$.get("toEditBranch",{id:e},function(t){t&&($(".alert").remove(),$.each(t,function(t,a){$("#library-action").val(a.id),$(".name").val(a.BranchName),$(".address").val(a.BAddress),$(".telephone").val(a.Telephone),$(".deactivate").attr("href","/delete-branch/"+e),$(".delete").show()}))}),$("#branch-library").modal("show")}function triggerEditCustomer(e){$.get("toEditCustomer",{id:e},function(t){t&&($(".alert").remove(),$.each(t,function(t,a){$("#library-action").val(a.id),$(".name").val(a.CustomerName),$(".address").val(a.Address),$(".telephone1").val(a.Telephone1),$(".telephone2").val(a.Telephone2),$(".contact-person").val(a.ContactPerson),$(".credit-limit").val(a.CreditLimit),$(".deactivate").attr("href","/delete-customer/"+e),$(".delete").show()}))}),$("#customer-library").modal("show")}function triggerEditUser(e){$.get("toEditUser",{id:e},function(t){if(t){$(".alert").remove();var a;$.each(t,function(t,d){1==d.UserType?a="Admin":11==d.UserType?a="Admin/Sales Rep":2==d.UserType?a="Warehouse User":3==d.UserType?a="Office Clerk":4==d.UserType&&(a="Sales Rep"),$("#library-action").val(d.id),$(".username").val(d.username),$(".lastname").val(d.Lastname),$(".firstname").val(d.Firstname),$(".mi").val(d.MI),$(".usertype").val(a),$(".deactivate").attr("href","/delete-user/"+e),$(".delete").show()})}}),$("#user-library").modal("show")}function editCategory(e){$("#modalCatError").addClass("hidden");var t=$(".category").DataTable(),a=jQuery.trim($("#catName"+e).text()),d=t.row("#category"+e).index();$("#catID").val(e),$("#catIndex").val(d),$("#txtCatName").val(a),$("#myModal").modal("show"),$(".modal-title").text("Edit "+a)}function editSupplier(e){$(".supplier").DataTable();$(".modal-title").text("Edit Supplier"),$("#supplierModal").modal("show"),$.post("/fetchSupplier",{id:e},function(e){$("#txtSupID").val(e.id),$("#SupplierName").val(e.SupplierName),$("#Address").val(e.Address),$("#Telephone1").val(e.Telephone1),$("#Telephone2").val(e.Telephone2),$("#ContactPerson").val(e.ContactPerson)})}function editProduct(e){$(".product").DataTable();$(".modal-title").text("Edit Product"),$("#productModal").modal("show"),$.post("/fetchProduct",{id:e},function(e){$("#txtProdID").val(e.id),$("#ProductCatNo").val(e.ProductCatNo),$("#ProductName").val(e.ProductName),$("#BrandName").val(e.BrandName),$("#WholeSaleUnit").val(e.WholeSaleUnit),$("#RetailUnit").val(e.RetailUnit),$("#RetailQtyPerWholeSaleUnit").val(e.RetailQtyPerWholeSaleUnit),$("#Reorderpoint").val(e.Reorderpoint),$("#Markup1").val(e.Markup1),$("#Markup2").val(e.Markup2),$("#Markup3").val(e.Markup3),$("#ActiveMarkup").val(e.ActiveMarkup)})}function numberOnlyInput(e){-1!==$.inArray(e.keyCode,[46,8,9,27,13,110,190])||65==e.keyCode&&e.ctrlKey===!0||e.keyCode>=35&&e.keyCode<=39||(e.shiftKey||e.keyCode<48||e.keyCode>57)&&(e.keyCode<96||e.keyCode>105)&&e.preventDefault()}$(function(){$.ajaxSetup({headers:{"X-CSRF-Token":$('meta[name="_token"]').attr("content")}});var e=window.location.hash;e&&$('ul.nav a[href="'+e+'"]').tab("show")});var itemno=1,counter=1;$(document).ready(function(){$("#current-password").blur(function(){var e=$(this).val();$.get("verifyCurrentPassword",{val:e},function(e){"0"==e?$(".alert").show():$(".alert").hide()})}),$.fn.editable.defaults.mode="inline",$(".pops").popover({trigger:"hover"}),$(".add-customer").click(function(){$("#library-action").val(""),$(".name").val(""),$(".address").val(""),$(".telephone1").val(""),$(".telephone2").val(""),$(".contact-person").val(""),$(".credit-limit").val(""),$(".delete").hide()}),$(".add-branch").click(function(){$("#library-action").val(""),$(".name").val(""),$(".address").val(""),$(".telephone").val(""),$(".delete").hide()}),$(".add-bank").click(function(){$("#library-action").val(""),$(".name").val(""),$(".address").val(""),$(".telephone").val(""),$(".delete").hide()});var e=document.title;document.getElementsByTagName("body")[0].id=e,$("ul.nav li.dropdown").hover(function(){$(".dropdown-menu",this).fadeIn()},function(){$(".dropdown-menu",this).fadeOut("fast")}),$("#"+e+" a:contains('"+e+"')").parent().addClass("active"),$("#"+e+" a:contains("+e+")").parent().addClass("active"),$(".sidehead ul:contains("+e+")").removeClass("collapse"),$("#sidebar-wrapper").hover(function(e){e.preventDefault(),$("#wrapper").addClass("toggled")},function(){$("#wrapper").removeClass("toggled")}),$("#ProductCategory").keyup(function(){$("#catError").addClass("hidden")}),$("#saveCategory").click(function(e){e.preventDefault();var t=jQuery.trim($("#ProductCategory").val());if(t&&0!=t.length){var a=$(".category").DataTable();$.post("/addCategory",{ProdCatName:t},function(e){if(0==e)$("#catError").text("Category already exists!"),$("#catError").removeClass("hidden");else{a.row.add([e.updated_at,e.ProdCatName,'<button class="btn btn-success btn-xs" onclick="editCategory('+e.id+');"><i class="fa fa-cog"></i> Edit</button>']).draw();{var t=a.rows(".selected").indexes();$(t).attr("id","category"+e.id)}$(" td:nth-child(1)").attr("id","catName"+e.id),$("#catError").addClass("hidden")}})}else $("#catError").text("Category text field is empty!"),$("#catError").removeClass("hidden");$("#ProductCategory").val(" ")}),$("#categoryBtn").click(function(){var e=$(".category").DataTable(),t=$("#catID").val(),a=$("#catIndex").val(),d=$("#txtCatName").val(),o=jQuery.trim($("#txtCatName").val());o&&0!=o.length?$.post("/editCategory",{id:t,ProdCatName:d},function(t){0==t?($("#modalCatError").text("Category already exists!"),$("#modalCatError").removeClass("hidden")):(e.cell(a,1).data(t).draw(),$("#myModal").modal("hide"))}):($("#modalCatError").text("Text field is empty!"),$("#modalCatError").removeClass("hidden"))}),$("#addSupplier").click(function(){$(".modal-title").text("Add new Supplier"),$("#txtSupID").val(null),$("input[type=text]").val(null),$("#supplierModal").modal("show")}),$("#addProduct").click(function(){$(".modal-title").text("Add new Product"),$("#txtProdID").val(null),$("input[type=text]").val(null),$("#productModal").modal("show")}),$(".sidehead").click(function(){$(this).children("ul").first().stop(!0,!0).slideToggle(500)}),$("#telephone,#telephone1,#telephone2").keydown(function(e){e.shiftKey||(e.keyCode<48||e.keyCode>57)&&(e.keyCode<96||e.keyCode>105)?8!=e.keyCode&&9!=e.keyCode&&107!=e.keyCode&&187!=e.keyCode&&116!=e.keyCode&&16!=e.keyCode&&109!=e.keyCode&&189!=e.keyCode&&($(".alert").show(),e.preventDefault()):$(".alert").hide()}),$("#term2,#edTerm2").click(function(){$("#termBox,#edTermBox").removeClass("hidden"),$("#term1,#edTerm1").removeClass("active"),$("#term,#edTerm").select()}),$("#term1,#edTerm1").click(function(){$("#termBox,#edTermBox").addClass("hidden"),$("#term2,#edTerm2").removeClass("active"),$("#term,#edTerm").val(0)}),$("#term,#edTerm").blur(function(){var e=jQuery.trim($(this).val());""==e&&$(this).val(0)}),$("#term,#edTerm").keydown(function(e){numberOnlyInput(e)}),$("#addProductPO").click(function(){$("#addProductPOModal").modal("show")}),$("#savePO").click(function(){function e(){var e=new Array;return $(".POtable tr").each(function(t,a){e[t]={ProdNo:$(a).find("td:eq(1)").text(),Unit:$(a).find("td:eq(4)").text(),Qty:$(a).find("td:eq(5)").text(),CostPerQty:$(a).find("td:eq(6)").text()}}),e.shift(),e}var t,a=$("#supplier").val(),d=$("#term").val(),o=$("#preparedBy").text();if($("#approved").is(":checked"))var r=o;else var r="";t=e(),t=$.toJSON(t),$.post("/savePO",{TD:t,supplier:a,term:d,preparedBy:o,approvedBy:r},function(e){1==e?(location.reload(),$("#successModal").modal("show")):0==e&&$("#savePOError").fadeIn("fast",function(){$("#savePOError").fadeOut(4e3)})})}),$("#vwSavePOBtn").click(function(){function e(){var e=new Array;return $(".edPOTable tr").each(function(t,a){e[t]={ProdNo:$(a).find("td:eq(1)").text(),Unit:$(a).find("td:eq(4)").text(),Qty:$(a).find("td:eq(5)").text(),CostPerQty:$(a).find("td:eq(6)").text()}}),e.shift(),e}var t,a=$("#edPOId").text(),d=$('[name="vwSupplier"]').val(),o=$("#edTerm").val();t=e(),t=$.toJSON(t),$.post("/saveEditedPO",{TD:t,supplier:d,term:o,id:a},function(e){1==e?location.reload():0==e&&alert("invalid move")})})});